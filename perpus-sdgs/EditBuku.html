<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Edit Buku</title>
  <link rel="stylesheet" href="DaftarBuku.css">
</head>
<body>
  <h2>Edit Buku</h2>

  <form id="editForm" method="post" action="EditBuku.php" enctype="multipart/form-data">
    <input type="hidden" name="id" id="id">

    <label>Judul:</label>
    <input type="text" name="judul" id="judul" required><br>

    <label>Penulis:</label>
    <input type="text" name="penulis" id="penulis" required><br>

    <label>Tahun:</label>
    <input type="number" name="tahun" id="tahun" required><br>

    <label>Kategori:</label>
    <input type="text" name="kategori" id="kategori" required><br>

    <label>Cover (Opsional):</label>
    <input type="file" name="cover"><br>

    <input type="submit" name="submit" value="Update">
  </form>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Ambil ID buku dari query string
      const urlParams = new URLSearchParams(window.location.search);
      const id = urlParams.get("id");

      if (!id) {
        alert("ID buku tidak ditemukan!");
        return;
      }

      // Set ID ke field tersembunyi
      document.getElementById("id").value = id;

      // Ambil data buku dari PHP menggunakan Fetch API
      fetch("EditBuku.php?id=" + id)
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            alert(data.error);
            return;
          }
          // Isi form dengan data buku
          document.getElementById("judul").value = data.title;
          document.getElementById("penulis").value = data.author;
          document.getElementById("tahun").value = data.year;
          document.getElementById("deskripsi").value = data.description;
        })
        .catch(error => {
          console.error("Gagal fetch data buku:", error);
        });
    });
  </script>
</body>
</html>
