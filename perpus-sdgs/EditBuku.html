<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Edit Buku</title>
  <link rel="stylesheet" href="DaftarBuku.css">
</head>
<body>
  <header>
    <div class="logo">Perpustakaan Desa</div>
    <nav>
      <ul>
        <li><a href="homepage_user.html">Home</a></li>
        <li><a href="DaftarBukuUser.html">Books</a></li>
      </ul>
    </nav>
</header>

  <div class="form-edit-buku">
    <h2>Edit Buku</h2>

    <form id="editForm" method="post" action="EditBuku.php" enctype="multipart/form-data">
      <input type="hidden" name="id" id="id">

      <label for="judul">Judul:</label>
      <input type="text" name="judul" id="judul" required>

      <label for="penulis">Penulis:</label>
      <input type="text" name="penulis" id="penulis" required>

      <label for="tahun">Tahun:</label>
      <input type="number" name="tahun" id="tahun" required>

      <label for="isbn">ISBN:</label>
      <input type="text" name="isbn" id="isbn" required>

      <label for="kategori">Kategori:</label>
      <input type="text" name="kategori" id="kategori" required>

      <label for="stock">Stock:</label>
      <input type="number" name="stock" id="stock" required>

      <label for="cover">Cover (Opsional):</label>
      <input type="file" name="cover" id="cover">

      <input type="submit" name="submit" value="Update">
    </form>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Ambil ID buku dari query string
      const urlParams = new URLSearchParams(window.location.search);
      const id = urlParams.get("id");

      if (!id) {
        alert("ID buku tidak ditemukan!");
        return;
      }

      // Set ID ke field tersembunyi
      document.getElementById("id").value = id;

      // Ambil data buku dari PHP menggunakan Fetch API
      fetch("EditBuku.php?id=" + id)
        .then(response => response.json())
        .then(data => {
          if (data.error) {
            alert(data.error);
            return;
          }
          // Isi form dengan data buku
          document.getElementById("judul").value = data.title;
          document.getElementById("penulis").value = data.author;
          document.getElementById("tahun").value = data.year;
          document.getElementById("isbn").value = data.isbn;
          document.getElementById("kategori").value = data.category;
          document.getElementById("stock").value = data.stock;  // Menambahkan stock
        })
        .catch(error => {
          console.error("Gagal fetch data buku:", error);
        });
    });
  </script>
</body>
</html>
